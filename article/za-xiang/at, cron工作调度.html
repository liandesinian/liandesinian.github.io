<!DOCTYPE html>
<html lang="zh">

<head>
      <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="canonical" href="/article/za-xiang/at, cron工作调度.html" />

    <title>  Avalon &mdash; at, cron工作调度
</title>




    <link rel="stylesheet" href="/theme/css/style.css">

    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->


    <meta name="author" content="莲的思念">
    <meta name="description" content="at是仅执行一次的工作调度，而cron是周期性地执行工作调度，也可以说是例行性工作。 At 要使用at，首先要有运行一个atd守护进程。 atd选项 -l load_avg：可指定负载限额。超出这个值batch就不会工作 -b batch_interval：指定两个batch jobs之间的最小间隔，以秒为单位。 /var/spool/atjobs：用来存储jobs，owner和group都为daemon，权限1770.其他用户执行at时以daemon的组身份执行。 /var/spool/atspool：用来存储输出, owner和group都为daemon，权限1770 at.allow文件存在，则只有这文件中记录的用户可以使用at。若不存在，则检查at.deny文件，不属于此文件中记录的用户可以使用at。若都没有则只有root可以使用。 at 在指定的时间运行命令。at的时间格式有很多，具体可以看/usr/share/doc/at/timespec -m：当job完成后发送mail给用户。 -l：显示用户定义的job ...">
  <meta name="tags" contents="">
</head>

<body>
<header class="header">
  <div class="container">
    <div class="header-inner">
      <h1 class="header-name">
        <a class="nodec" href="/">Avalon</a>
      </h1>
      <h3 class="header-text">忆惜往日如作梦，月洒清辉映琉璃。</h3>
      <ul class="header-menu list-inline">
		<li><a class="nodec" href="/category/an-quan.html">安全</a></li>
		<li><a class="nodec" href="/category/python.html">Python</a></li>
		<li><a class="nodec" href="/category/wang-luo.html">网络</a></li>
		<li><a class="nodec" href="/category/za-xiang.html">杂项</a></li>
		
      </ul>
    </div>
  </div>
</header> <!-- /.header -->  <div class="container">
  <div class="post full-post">
    <h1 class="post-title">
		<a href="/article/za-xiang/at, cron工作调度.html" title="at, cron工作调度">at, cron工作调度</a>
    </h1>
    <ul class="list-inline">
      <li class="post-date">
        <a class="text-muted" title="2015-03-23T00:00:00+08:00">2015年03月23日</a>
      </li>
      <li class="muted">&middot;</li>
      <li class="post-category">
	  <a href="/category/za-xiang.html">杂项</a>
      </li>
    </ul>
    <div class="post-content">
      <p>at是仅执行一次的工作调度，而cron是周期性地执行工作调度，也可以说是例行性工作。</p>
<h1> At </h1>

<p>要使用at，首先要有运行一个atd守护进程。</p>
<h2> atd选项 </h2>

<ol>
<li>-l load_avg：可指定负载限额。超出这个值batch就不会工作</li>
<li>-b batch_interval：指定两个batch jobs之间的最小间隔，以秒为单位。</li>
</ol>
<p>/var/spool/atjobs：用来存储jobs，owner和group都为daemon，权限1770.其他用户执行at时以daemon的组身份执行。</p>
<p>/var/spool/atspool：用来存储输出, owner和group都为daemon，权限1770</p>
<p>at.allow文件存在，则只有这文件中记录的用户可以使用at。若不存在，则检查at.deny文件，不属于此文件中记录的用户可以使用at。若都没有则只有root可以使用。</p>
<h2> at </h2>

<p>在指定的时间运行命令。at的时间格式有很多，具体可以看/usr/share/doc/at/timespec</p>
<ol>
<li>-m：当job完成后发送mail给用户。</li>
<li>-l：显示用户定义的job</li>
<li>-d：删除job</li>
<li>-c：显示job的具体命令内容</li>
</ol>
<h2> batch </h2>

<p>当系统负载低于限额时执行命令。</p>
<h1> cron </h1>

<p>cron.allow，cron.deny文件和at.allow, at.deny相同。</p>
<p>用户使用crontab来新建工作调度后，该工作就被记录到/var/spool/cron/crontabs中对应的用户名文件。</p>
<h2> crontab选项 </h2>

<ol>
<li>-u：只有root可用，帮用户新建和删除jobs。</li>
<li>-e：编辑jobs</li>
<li>-l：显示jobs</li>
<li>-d：删除所有jobs</li>
</ol>
<p>但是crond只适用于全天开机的情况下适用，对于经常需要关机的电脑来说，就需要使用anacron。anacron以天为单位或是在开机后立刻进行anacron操作，它会去检测停机期间应该进行而没有进行的crontab工作，并将其执行。</p>
<h1> anacron </h1>

<p>anacron不像cron，它并不假设系统是不间断运行的，因此它可以被用在哪些并非一天24小时都开机的系统上执行周期性的工作。
当anacron运行时，它会读取配置文件来查看相应的工作设置的间隔天数，如果天数超过则根据设置的延迟时间，延迟相应的时间后执行，执行结束就退出。为了比较现在的时间与上次执行的时间，anacron有一个时间记录文件。</p>
<h2> anacron选项 </h2>

<ol>
<li>-u：仅更新时间记录文件的时间戳，不进行任何工作。</li>
<li>-s：依次执行工作，在前一个结束前不会执行下一个。若不加，则只要延迟一过就开始执行，各工作之间是独立的。</li>
<li>-n：立刻开始执行，不进行延迟</li>
<li>/etc/anacrontab：设定工作的文件</li>
<li>/var/spool/anacron：用来存储时间戳文件。</li>
</ol>
    </div>
  </div>
  <hr class="separator">
  <div class="col-md-8 col-md-offset-2">
  <div id="disqus_thread">
    <script>
      var disqus_shortname = 'liandesinian';
      (function() {
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] ||
         document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
    </script>
    <noscript>
      Please enable JavaScript to view the
      <a href="https://disqus.com/?ref_noscript=liandesinian">
        comments powered by Disqus.
      </a>
    </noscript>
    <a href="https://disqus.com" class="dsq-brlink">
      blog comments powered by <span class="logo-disqus">Disqus</span>
    </a>
  </div>
  </div>
  </div>
<footer class="footer">
  <div class="container">
    <p class="text-center">
      莲的思念, <a href="" target="_blank"></a> unless otherwise noted.
    </p>
    <div class="text-center">
      Generated by <a href="http://getpelican.com" target="_blank">Pelican</a> with the <a href="http://github.com/nairobilug/pelican-alchemy">alchemy</a> theme.
    </div>
  </div>
</footer> <!-- /.footer -->
  <script src="/theme/js/jquery.min.js"></script>
  <script src="/theme/js/bootstrap.min.js"></script>
</body> <!-- 42 -->

</html>